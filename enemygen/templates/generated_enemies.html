{% load url from future %}

<html>
<head>
<title>RQ: {% if party %}{{ party.name }}{% else %}{{ enemies.0.name }}{% endif %}</title>

<style type="text/css">
body, table{
    font-size: 12px;
}

.template_name{
    font-weight: bold;
}

div.row_container{
    width: 880px;
    position: relative;
    page-break-inside: avoid;
    padding-bottom: 50px;
    vertical-align: top;
}

div.enemy_container{
    margin-top: 15px;
    margin-right: 0px;
    width: 420px;
    display: inline-block;
    page-break-inside: avoid;
    vertical-align: top;
}

.enemy_table{
    background: white;
    font-family: Serif;
    border-collapse: collapse;
    font-size: 12px;
}

.enemy_table td, th{
    font-size: 12px;
}

.inner_enemy_table{
    border-collapse: collapse;
}

.inner_enemy_table td{
    padding: 2px;
}

.toprow{
    background: #555;
    color: white;
}
.evenrow{
    line-height: 15px;
}

.oddrow{
    background: #CCC;
    line-height: 15px;
}

.title{
    font-weight: bold;
}

table .item_list{
    font-style: italic;
}

table.weapon_table{
    border-spacing: 0px;
}

table.weapon_table tr td{
    font-size: 12px;
}

a {
    text-decoration: none;
    color: black;
}

a:hover{
    text-decoration: underline;
}

.page_break{
    page-break-after: always;
}

div#pdf_export{
    position: absolute;
    top: 5px;
    left: 700px;
    z-index: 3;
}

@media print{
    div#pdf_export{
        display: none;
    }
}

</style>
</head>
<body>
{% if party.notes %}
    <p>Notes:</p>
    <p>{{ party.notes }}</p>
{% endif %}

{% if generated_html %}
<div id="pdf_export">
<form action="{% url 'pdf_export' %}" method="GET">
<input type="hidden" name="generated_html" value="{{ generated_html }}">
<input type="hidden" name="action" value="pdf_export">
<input type="submit" value="PDF Export">
</form>
</div>
{% endif %}

<div class="row_container">
{% for enemy in enemies %}
<div class="enemy_container">
<table class="enemy_table">
    <tr><td colspan="3"><span class="template_name"><a href="{% url 'enemy_template' enemy.et.id %}">{{ enemy.name }}</a></span></td></tr>
    <tr><td valign="top">
        <table class="inner_enemy_table" id="characteristics">
            <tr class="toprow"><th>Chars</th></tr>
            {% for stat in enemy.get_stats %}
                <tr><td class="{% if forloop.counter|divisibleby:2 %}evenrow{% else %}oddrow{% endif %}">
                    {{ stat.name }}:&nbsp;{{ stat.value }}
                </td></tr>
            {% endfor %}
        </table>
    </td><td valign="top">
        <table class="inner_enemy_table" id="attributes">
            <tr class="toprow"> <th colspan="2">Attributes</th></tr>
            <tr class="oddrow"> <td>Action Points</td>  <td>{{ enemy.attributes.action_points }}</td></tr>
            <tr class="evenrow"><td>Damage Modifier</td><td>{{ enemy.attributes.damage_modifier }}</td></tr>
            <tr class="oddrow"> <td>Magic Points</td>   <td>{{ enemy.attributes.magic_points }}</td></tr>
            <tr class="evenrow"><td>Movement</td>       <td>{{ enemy.attributes.movement }}</td></tr>
            <tr class="oddrow"> <td>Strike Rank</td>    <td>{{ enemy.attributes.strike_rank }}</td></tr>
            <tr class="evenrow"><td>&nbsp;</td>         <td>{{ enemy.attributes. }}</td></tr>
            <tr class="oddrow"> <td>&nbsp;</td>         <td>{{ enemy.attributes. }}</td></tr>
        </table>
    {% if enemy.hit_locations %}
    </td><td valign="top">
        <table class="inner_enemy_table" id="hit_locations">
            <tr class="toprow"><th>1D20</th><th>Location</th><th>AP/HP</th></tr>
            {% for hl in enemy.hit_locations %}
                <tr class="{% if forloop.counter|divisibleby:2 %}evenrow{% else %}oddrow{% endif %}">
                    <td>{{ hl.range|safe }}</td><td>{{ hl.name }}</td><td align="right">{{ hl.ap }}/{{ hl.hp }}</td>
                </tr>
            {% endfor %}
        </table>
    {% endif %}
    </td></tr>
</table>
    
<span class="title">Skills:</span><span class="item_list">
    {% for skill in enemy.skills %}
        {{ skill.name }} {{skill.value}}%{% if not forloop.last %}, {% endif %}
    {% endfor %}
</span><br>

{% if enemy.folk_spells %}
    <span class="title">Folk magic spells:</span><span class="item_list">
        {% for spell in enemy.folk_spells %}
            {{ spell.name }}{% if spell.detail %} {{ spell.detail }}{% endif %}{% if not forloop.last %}, {% endif %}
        {% endfor %}
    </span><br>
{% endif %}

{% if enemy.sorcery_spells %}
    <span class="title">Sorcery spells:</span><span class="item_list">
        {% for spell in enemy.sorcery_spells %}
            {{ spell.name }}{% if spell.detail %} {{ spell.detail }}{% endif %}{% if not forloop.last %}, {% endif %}
        {% endfor %}
    </span><br>
{% endif %}

{% if enemy.theism_spells %}
    <span class="title">Theism spells/Miracles:</span><span class="item_list">
        {% for spell in enemy.theism_spells %}
            {{ spell.name }}{% if spell.detail %} {{ spell.detail }}{% endif %}{% if not forloop.last %}, {% endif %}
        {% endfor %}
    </span><br>
{% endif %}

<span class="title">Combat Styles:</span>
<span class="item_list">
    {% for cs in enemy.combat_styles %}
        {{ cs.name }} {{ cs.value }}%{% if not forloop.last %}, {% endif %}
        {% if cs.weapons %}
        <table class="weapon_table">
            <tr><th align="left">Weapon</th><th>Size/Force</th><th>Reach</th><th>Damage</th><th>AP/HP</th></tr>
            {% for weapon in cs.weapons %}
                <tr>
                    <td>{{ weapon.name }}</td>
                    <td>{{weapon.size}}</td>
                    <td>{{weapon.reach}}</td>
                    <td>{{weapon.damage}}{% if enemy.attributes.damage_modifier != '+0' %}{{ enemy.attributes.damage_modifier }}{% endif %}</td>
                    <td>{{weapon.ap}}/{{weapon.hp}}</td>
                </tr>
            {% endfor %}
        </table>
        {% endif %}
    {% endfor %}
</span>

{% if enemy.notes %}
<span class="title">Notes:</span>
<span class="item_list">{{ enemy.notes }}</span>
{% endif %}

</div>
{% if not forloop.first and not forloop.last and forloop.counter|divisibleby:"2" %}</div><div class="row_container">{% endif %}
{% endfor %}
</div>

</body>
</html>