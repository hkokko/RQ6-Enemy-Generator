{% extends "base.html" %}
{% load url from future %}

{% block content %}
<div><p>Type to search: <input id="searchinput" /></p></div>

<form action="{% url 'generate_enemies' %}" method="post" target="_blank">
{% csrf_token %}
<div id="enemy_template_list_container">
<table id="enemy_template_list" class="index_list">
    <thead><tr>
        <th class="sort-alpha">Enemy type</th>
        <th>Amount</th>
        <th class="sort-alpha">Race</th>
        <th class="sort-alpha">Rank</th>
        <th class="sort-alpha">Creator</th>
        <th class="sort-alpha">Tags</th>
    </tr></thead>
    {% for et in templates %}
        <tr>
            <td><a class="edit_item" href="{% url 'enemy_template' et.id %}">{{ et.name }}</a> {% if not et.published %}<b>*</b>{% endif %}</td>
            <td><input name="enemy_template_id_{{et.id}}" min="1" max="40" type="number"></td>
            <td><a class="edit_item" href="{% url 'race' et.race.id %}">{{ et.race.name }}</a></td>
            <td>
                {% if et.rank = 1 %}1&nbsp;Rabble{% endif %}
                {% if et.rank = 2 %}2&nbsp;Novice{% endif %}
                {% if et.rank = 3 %}3&nbsp;Skilled{% endif %}
                {% if et.rank = 4 %}4&nbsp;Veteran{% endif %}
                {% if et.rank = 5 %}5&nbsp;Master{% endif %}
            </td>
            <td>{{ et.owner }}</td>
            <td><div id="index_tag_container">
                {% for tag in et.get_tags %}<div class="small_tag">{{tag}}</div>{% endfor %}
            </div></td>
        </tr>
    {% endfor %}
</table>
</div>
{% if user.username %}
<p><b>*</b> Unpublished</p>
{% endif %}

<input type="submit" value="Generate">
</form>

<br><br>

<script>
function template_list_height(){
    list_container_height = $(window).height() - 385
    if (list_container_height > $('#enemy_template_list').height()){
        list_container_height = $('#enemy_template_list').height()
    }
    return list_container_height;

}

$(document).ready(function(){
    var table = new ttable('enemy_template_list'); 
    table.sorting.enabled = true;
    table.sorting.sortall = false;
    table.search.enabled = true;
    table.search.inputID = 'searchinput';
    table.search.casesensitive = false;
    table.style.num = false;
    table.rendertable();
    
    $('#enemy_template_list_container').css('height', template_list_height());
    $(window).resize(function(event){
        $('#enemy_template_list_container').css('height', template_list_height());
    })
});
</script>

{% endblock %}